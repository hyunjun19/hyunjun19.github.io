{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/landscape/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"themes/landscape/source/js/script.js","path":"js/script.js","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":1,"renderable":1},{"_id":"themes/landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":1,"renderable":1}],"Cache":[{"_id":"themes/landscape/.gitignore","hash":"58d26d4b5f2f94c2d02a4e4a448088e4a2527c77","modified":1503565818000},{"_id":"themes/landscape/README.md","hash":"c7e83cfe8f2c724fc9cac32bd71bb5faf9ceeddb","modified":1503565818000},{"_id":"themes/landscape/Gruntfile.js","hash":"71adaeaac1f3cc56e36c49d549b8d8a72235c9b9","modified":1503565818000},{"_id":"themes/landscape/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1503565818000},{"_id":"themes/landscape/.DS_Store","hash":"c382e91dd2f72e2007a9380b6d7aa9dfc80f8231","modified":1503634546000},{"_id":"themes/landscape/_config.yml","hash":"fb8c98a0f6ff9f962637f329c22699721854cd73","modified":1503565818000},{"_id":"themes/landscape/package.json","hash":"85358dc34311c6662e841584e206a4679183943f","modified":1503565818000},{"_id":"source/_posts/ts-spring-session-oome.md","hash":"0ae128ba4b9bca2f28d0084fbee43772860e74a5","modified":1503565818000},{"_id":"source/_posts/ts-ios-wifi-webkit-error.md","hash":"93d805f0e6b620e22f5a92d0f029847b49f40f01","modified":1503576121000},{"_id":"themes/landscape/languages/default.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1503565818000},{"_id":"themes/landscape/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1503565818000},{"_id":"themes/landscape/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1503565818000},{"_id":"themes/landscape/languages/fr.yml","hash":"84ab164b37c6abf625473e9a0c18f6f815dd5fd9","modified":1503565818000},{"_id":"themes/landscape/languages/zh-CN.yml","hash":"ca40697097ab0b3672a80b455d3f4081292d1eed","modified":1503565818000},{"_id":"themes/landscape/languages/zh-TW.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1503565818000},{"_id":"themes/landscape/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1503565818000},{"_id":"themes/landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1503565818000},{"_id":"themes/landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1503565818000},{"_id":"themes/landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1503565818000},{"_id":"themes/landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1503565818000},{"_id":"themes/landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1503565818000},{"_id":"themes/landscape/layout/layout.ejs","hash":"f155824ca6130080bb057fa3e868a743c69c4cf5","modified":1503565818000},{"_id":"themes/landscape/scripts/fancybox.js","hash":"aa411cd072399df1ddc8e2181a3204678a5177d9","modified":1503565818000},{"_id":"themes/landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1503565818000},{"_id":"themes/landscape/source/.DS_Store","hash":"3037d5331d92d3f549f33102664cadfff9459707","modified":1503634546000},{"_id":"themes/landscape/layout/_partial/after-footer.ejs","hash":"82a30f81c0e8ba4a8af17acd6cc99e93834e4d5e","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/article.ejs","hash":"c4c835615d96a950d51fa2c3b5d64d0596534fed","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/archive.ejs","hash":"931aaaffa0910a48199388ede576184ff15793ee","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/archive-post.ejs","hash":"c7a71425a946d05414c069ec91811b5c09a92c47","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/footer.ejs","hash":"93518893cf91287e797ebac543c560e2a63b8d0e","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/header.ejs","hash":"c21ca56f419d01a9f49c27b6be9f4a98402b2aa3","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/head.ejs","hash":"4fe8853e864d192701c03e5cd3a5390287b90612","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/mobile-nav.ejs","hash":"e952a532dfc583930a666b9d4479c32d4a84b44e","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/sidebar.ejs","hash":"930da35cc2d447a92e5ee8f835735e6fd2232469","modified":1503565818000},{"_id":"themes/landscape/layout/_widget/archive.ejs","hash":"beb4a86fcc82a9bdda9289b59db5a1988918bec3","modified":1503565818000},{"_id":"themes/landscape/layout/_widget/category.ejs","hash":"dd1e5af3c6af3f5d6c85dfd5ca1766faed6a0b05","modified":1503565818000},{"_id":"themes/landscape/layout/_widget/recent_posts.ejs","hash":"0d4f064733f8b9e45c0ce131fe4a689d570c883a","modified":1503565818000},{"_id":"themes/landscape/layout/_widget/tag.ejs","hash":"2de380865df9ab5f577f7d3bcadf44261eb5faae","modified":1503565818000},{"_id":"themes/landscape/source/css/_extend.styl","hash":"222fbe6d222531d61c1ef0f868c90f747b1c2ced","modified":1503565818000},{"_id":"themes/landscape/layout/_widget/tagcloud.ejs","hash":"b4a2079101643f63993dcdb32925c9b071763b46","modified":1503565818000},{"_id":"themes/landscape/source/css/.DS_Store","hash":"489e4612ad71be2fd5fb4eb6cbb81cd7d51626ee","modified":1503634551000},{"_id":"themes/landscape/source/css/_variables.styl","hash":"5e37a6571caf87149af83ac1cc0cdef99f117350","modified":1503565818000},{"_id":"themes/landscape/source/css/style.styl","hash":"a70d9c44dac348d742702f6ba87e5bb3084d65db","modified":1503565818000},{"_id":"themes/landscape/source/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/post/date.ejs","hash":"6197802873157656e3077c5099a7dda3d3b01c29","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/post/tag.ejs","hash":"2fcb0bf9c8847a644167a27824c9bb19ac74dd14","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/post/category.ejs","hash":"c6bcd0e04271ffca81da25bcff5adf3d46f02fc0","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/archive.styl","hash":"db15f5677dc68f1730e82190bab69c24611ca292","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/post/nav.ejs","hash":"16a904de7bceccbb36b4267565f2215704db2880","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/article.styl","hash":"10685f8787a79f79c9a26c2f943253450c498e3e","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/comment.styl","hash":"79d280d8d203abb3bd933ca9b8e38c78ec684987","modified":1503565818000},{"_id":"themes/landscape/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/footer.styl","hash":"e35a060b8512031048919709a8e7b1ec0e40bc1b","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/header.styl","hash":"85ab11e082f4dd86dde72bed653d57ec5381f30c","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/sidebar-aside.styl","hash":"890349df5145abf46ce7712010c89237900b3713","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/highlight.styl","hash":"bf4e7be1968dad495b04e83c95eac14c4d0ad7c0","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/mobile.styl","hash":"a399cf9e1e1cec3e4269066e2948d7ae5854d745","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/sidebar.styl","hash":"404ec059dc674a48b9ab89cd83f258dec4dcb24d","modified":1503565818000},{"_id":"themes/landscape/source/css/_partial/sidebar-bottom.styl","hash":"8fd4f30d319542babfd31f087ddbac550f000a8a","modified":1503565818000},{"_id":"themes/landscape/source/css/_util/grid.styl","hash":"0bf55ee5d09f193e249083602ac5fcdb1e571aed","modified":1503565818000},{"_id":"themes/landscape/source/css/_util/mixin.styl","hash":"44f32767d9fd3c1c08a60d91f181ee53c8f0dbb3","modified":1503565818000},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1503565818000},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1503565818000},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1503565818000},{"_id":"themes/landscape/source/css/images/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1503634723000},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1503565818000},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1503565818000},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1503565818000},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1503565818000},{"_id":"themes/landscape/source/css/images/banner.jpg","hash":"bc56e9cb49fdb42ebede0282b7edeef2dc48126c","modified":1500552855000},{"_id":"public/2017/08/24/ts-ios-wifi-webkit-error/index.html","hash":"56e6f68affeb605ecc06ea32162ada6a958860c6","modified":1503634779135},{"_id":"public/archives/index.html","hash":"2dbc89fcaedc8c887a11524a7f21cad02fdcb309","modified":1503634779135},{"_id":"public/archives/2017/index.html","hash":"3e9675868979e9f2b5b6e400d550995709db4be2","modified":1503634779135},{"_id":"public/archives/2017/08/index.html","hash":"317a39a72025b6e9b67e73f2d811f31e474403b0","modified":1503634779136},{"_id":"public/2017/08/24/ts-spring-session-oome/index.html","hash":"9241d16e8f6de406df66a0ede935d10d555f97d5","modified":1503634779136},{"_id":"public/index.html","hash":"23a501355d33525c9371d08b722b2d7b838ebd4e","modified":1503634779136},{"_id":"public/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1503634779140},{"_id":"public/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1503634779140},{"_id":"public/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1503634779140},{"_id":"public/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1503634779140},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1503634779140},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1503634779141},{"_id":"public/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1503634779141},{"_id":"public/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1503634779141},{"_id":"public/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1503634779141},{"_id":"public/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1503634779142},{"_id":"public/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1503634779649},{"_id":"public/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1503634779655},{"_id":"public/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1503634779655},{"_id":"public/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1503634779656},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1503634779657},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1503634779657},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1503634779657},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1503634779657},{"_id":"public/css/style.css","hash":"fffb3966bf36057a325498aba9ce3a2ea7bd79e1","modified":1503634779657},{"_id":"public/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1503634779657},{"_id":"public/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1503634779657},{"_id":"public/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1503634779659},{"_id":"public/css/images/banner.jpg","hash":"bc56e9cb49fdb42ebede0282b7edeef2dc48126c","modified":1503634779667}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"ts-spring-session-oome","date":"2017-08-24T07:20:28.000Z","_content":"\n# [Trouble Shooting] spring-session OOME\n\n## 증상\n1. 2번 서버가 OutOfMemoryError로 갑자기 죽어버렸음\n2. KT 로드밸런서가 2번 서버로 계속 요청을 보냄\n3. 사용자의 요청이 1번 서버로만 간 경우 정상적으로 서비스를 이용\n4. 사용자의 요청이 2번으로 하나라도 가면 API의 응답을 받지 못함\n\n```log\n2017-08-04 19:40:51 [gajago-front] [redisMessageListenerContainer-1] ERROR org.springframework.data.redis.listener.RedisMessageListenerContainer:handleSubscriptionException:648 - SubscriptionTask aborted with exception:\njava.lang.OutOfMemoryError: unable to create new native thread\n        at java.lang.Thread.start0(Native Method)\n        at java.lang.Thread.start(Thread.java:714)\n        at org.springframework.core.task.SimpleAsyncTaskExecutor.doExecute(SimpleAsyncTaskExecutor.java:213)\n        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:171)\n        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:151)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer.dispatchMessage(RedisMessageListenerContainer.java:958)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer.access$1400(RedisMessageListenerContainer.java:71)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer$DispatchMessageListener.onMessage(RedisMessageListenerContainer.java:949)\n        at org.springframework.data.redis.connection.jedis.JedisMessageListener.onPMessage(JedisMessageListener.java:43)\n        at redis.clients.jedis.BinaryJedisPubSub.process(BinaryJedisPubSub.java:109)\n        at redis.clients.jedis.BinaryJedisPubSub.proceedWithPatterns(BinaryJedisPubSub.java:75)\n        at redis.clients.jedis.BinaryJedis.psubscribe(BinaryJedis.java:2953)\n        at org.springframework.data.redis.connection.jedis.JedisConnection.pSubscribe(JedisConnection.java:2959)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.eventuallyPerformSubscription(RedisMessageListenerContainer.java:773)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.run(RedisMessageListenerContainer.java:740)\n        at java.lang.Thread.run(Thread.java:745)\nException in thread \"http-apr-10090-Acceptor-0\" java.lang.OutOfMemoryError: unable to create new native thread\n        at java.lang.Thread.start0(Native Method)\n        at java.lang.Thread.start(Thread.java:714)\n        at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950)\n        at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368)\n        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:161)\n        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:141)\n        at org.apache.catalina.core.StandardThreadExecutor.execute(StandardThreadExecutor.java:169)\n        at org.apache.tomcat.util.net.AprEndpoint.processSocketWithOptions(AprEndpoint.java:909)\n        at org.apache.tomcat.util.net.AprEndpoint$Acceptor.run(AprEndpoint.java:1086)\n        at java.lang.Thread.run(Thread.java:745)\n```\n\n## 원인\n1. [spring-session](https://github.com/spring-projects/spring-session)에서 [spring-data-redis]를 사용할 때 [RedisMessageListenerContainer의 taskExecutor](https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L97)에 별도의 값을 설정하지 않아서 [SimpleAsyncTaskExecutor](https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java)를 사용하고 있음\n2. [SimpleAsyncTaskExecutor 문서](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html)에서 이 클래스는 쓰레드를 재사용하지 않으니 실행시간이 짧은 많은 수의 작업에는 사용하지 말라고 권장하고 있음\n    - ``NOTE: This implementation does not reuse threads! Consider a thread-pooling TaskExecutor implementation instead, in particular for executing a large number of short-lived tasks.``\n3. spring-session에서 세션정보에 접근하기 위해서 redis를 사용할 때 마다 Thread가 매번 생성됨\n4. 접속량이 많이지게 되면 ``OutOfMemoryError`` 발생\n\n## 해결책\n1. SimpleAsyncTaskExecutor 대신에 ThreadPool을 사용할 수 있도록 지정한다\n2. 하지만 지금 사용중인 ``spring-session-1.0.2.RELEASE`` 버전에서는 taskExecutor를 별도로 지정할 수 있는 방법이 없음\n3. 결국 ``spring-session-1.3.1.RELEASE`` 버전으로 업데이트\n4. [패치된 내용](https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92)을 바탕으로 ``springSessionRedisTaskExecutor``를 지정\n5. ``springSessionRedisTaskExecutor``를 지정하면 일어나는 일\n  1. ``springSessionRedisTaskExecutor``를 지정하면 ``RedisHttpSessionConfiguration.redisTaskExecutor``에 지정한 ``springSessionRedisTaskExecutor``가 할당 됨 [소스코드](https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L203)\n  2. ``RedisMessageListenerContainer.taskExecutor``에 ``RedisHttpSessionConfiguration.redisTaskExecutor``가 할당 됨 [소스코드](https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L93)\n  3. spring-session에서 redis를 사용할 때 ``springSessionRedisTaskExecutor``를 사용하게 됨 [소스코드](https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L961)\n\n```java\n@Configuration\npublic class FrontSessionConfig {\n    @Bean\n    public Executor springSessionRedisTaskExecutor() {\n        ThreadFactory threadFactory = new ThreadFactory() {\n            private int threadCount = 0;\n\n            @Override\n            public Thread newThread(Runnable runnable) {\n                return new Thread(runnable, String.format(\"gajago-session-redis-%d\", ++threadCount));\n            }\n        };\n\n        return Executors.newCachedThreadPool(threadFactory);\n    }\n}\n```\n\n\n## 남아있는 과제\n1. 왜 1번 서버는 안 죽고 2번 서버만 죽었을까?\n2. KT 로드밸런서가 왜 2번 서버로 계속 요청을 보냈을까?\n3. 캐시로 사용하고 있는 redis의 taskExecutor는?\n\n## 관련자료\n* https://github.com/spring-projects/spring-session\n* https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92\n* https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java\n* https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html\n","source":"_posts/ts-spring-session-oome.md","raw":"---\ntitle: ts-spring-session-oome\ndate: 2017-08-24 16:20:28\ntags:\n---\n\n# [Trouble Shooting] spring-session OOME\n\n## 증상\n1. 2번 서버가 OutOfMemoryError로 갑자기 죽어버렸음\n2. KT 로드밸런서가 2번 서버로 계속 요청을 보냄\n3. 사용자의 요청이 1번 서버로만 간 경우 정상적으로 서비스를 이용\n4. 사용자의 요청이 2번으로 하나라도 가면 API의 응답을 받지 못함\n\n```log\n2017-08-04 19:40:51 [gajago-front] [redisMessageListenerContainer-1] ERROR org.springframework.data.redis.listener.RedisMessageListenerContainer:handleSubscriptionException:648 - SubscriptionTask aborted with exception:\njava.lang.OutOfMemoryError: unable to create new native thread\n        at java.lang.Thread.start0(Native Method)\n        at java.lang.Thread.start(Thread.java:714)\n        at org.springframework.core.task.SimpleAsyncTaskExecutor.doExecute(SimpleAsyncTaskExecutor.java:213)\n        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:171)\n        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:151)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer.dispatchMessage(RedisMessageListenerContainer.java:958)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer.access$1400(RedisMessageListenerContainer.java:71)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer$DispatchMessageListener.onMessage(RedisMessageListenerContainer.java:949)\n        at org.springframework.data.redis.connection.jedis.JedisMessageListener.onPMessage(JedisMessageListener.java:43)\n        at redis.clients.jedis.BinaryJedisPubSub.process(BinaryJedisPubSub.java:109)\n        at redis.clients.jedis.BinaryJedisPubSub.proceedWithPatterns(BinaryJedisPubSub.java:75)\n        at redis.clients.jedis.BinaryJedis.psubscribe(BinaryJedis.java:2953)\n        at org.springframework.data.redis.connection.jedis.JedisConnection.pSubscribe(JedisConnection.java:2959)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.eventuallyPerformSubscription(RedisMessageListenerContainer.java:773)\n        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.run(RedisMessageListenerContainer.java:740)\n        at java.lang.Thread.run(Thread.java:745)\nException in thread \"http-apr-10090-Acceptor-0\" java.lang.OutOfMemoryError: unable to create new native thread\n        at java.lang.Thread.start0(Native Method)\n        at java.lang.Thread.start(Thread.java:714)\n        at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950)\n        at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368)\n        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:161)\n        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:141)\n        at org.apache.catalina.core.StandardThreadExecutor.execute(StandardThreadExecutor.java:169)\n        at org.apache.tomcat.util.net.AprEndpoint.processSocketWithOptions(AprEndpoint.java:909)\n        at org.apache.tomcat.util.net.AprEndpoint$Acceptor.run(AprEndpoint.java:1086)\n        at java.lang.Thread.run(Thread.java:745)\n```\n\n## 원인\n1. [spring-session](https://github.com/spring-projects/spring-session)에서 [spring-data-redis]를 사용할 때 [RedisMessageListenerContainer의 taskExecutor](https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L97)에 별도의 값을 설정하지 않아서 [SimpleAsyncTaskExecutor](https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java)를 사용하고 있음\n2. [SimpleAsyncTaskExecutor 문서](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html)에서 이 클래스는 쓰레드를 재사용하지 않으니 실행시간이 짧은 많은 수의 작업에는 사용하지 말라고 권장하고 있음\n    - ``NOTE: This implementation does not reuse threads! Consider a thread-pooling TaskExecutor implementation instead, in particular for executing a large number of short-lived tasks.``\n3. spring-session에서 세션정보에 접근하기 위해서 redis를 사용할 때 마다 Thread가 매번 생성됨\n4. 접속량이 많이지게 되면 ``OutOfMemoryError`` 발생\n\n## 해결책\n1. SimpleAsyncTaskExecutor 대신에 ThreadPool을 사용할 수 있도록 지정한다\n2. 하지만 지금 사용중인 ``spring-session-1.0.2.RELEASE`` 버전에서는 taskExecutor를 별도로 지정할 수 있는 방법이 없음\n3. 결국 ``spring-session-1.3.1.RELEASE`` 버전으로 업데이트\n4. [패치된 내용](https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92)을 바탕으로 ``springSessionRedisTaskExecutor``를 지정\n5. ``springSessionRedisTaskExecutor``를 지정하면 일어나는 일\n  1. ``springSessionRedisTaskExecutor``를 지정하면 ``RedisHttpSessionConfiguration.redisTaskExecutor``에 지정한 ``springSessionRedisTaskExecutor``가 할당 됨 [소스코드](https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L203)\n  2. ``RedisMessageListenerContainer.taskExecutor``에 ``RedisHttpSessionConfiguration.redisTaskExecutor``가 할당 됨 [소스코드](https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L93)\n  3. spring-session에서 redis를 사용할 때 ``springSessionRedisTaskExecutor``를 사용하게 됨 [소스코드](https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L961)\n\n```java\n@Configuration\npublic class FrontSessionConfig {\n    @Bean\n    public Executor springSessionRedisTaskExecutor() {\n        ThreadFactory threadFactory = new ThreadFactory() {\n            private int threadCount = 0;\n\n            @Override\n            public Thread newThread(Runnable runnable) {\n                return new Thread(runnable, String.format(\"gajago-session-redis-%d\", ++threadCount));\n            }\n        };\n\n        return Executors.newCachedThreadPool(threadFactory);\n    }\n}\n```\n\n\n## 남아있는 과제\n1. 왜 1번 서버는 안 죽고 2번 서버만 죽었을까?\n2. KT 로드밸런서가 왜 2번 서버로 계속 요청을 보냈을까?\n3. 캐시로 사용하고 있는 redis의 taskExecutor는?\n\n## 관련자료\n* https://github.com/spring-projects/spring-session\n* https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92\n* https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java\n* https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html\n","slug":"ts-spring-session-oome","published":1,"updated":"2017-08-24T09:10:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6rdboof0000xpwc2wuxah7g","content":"<h1 id=\"Trouble-Shooting-spring-session-OOME\"><a href=\"#Trouble-Shooting-spring-session-OOME\" class=\"headerlink\" title=\"[Trouble Shooting] spring-session OOME\"></a>[Trouble Shooting] spring-session OOME</h1><h2 id=\"증상\"><a href=\"#증상\" class=\"headerlink\" title=\"증상\"></a>증상</h2><ol>\n<li>2번 서버가 OutOfMemoryError로 갑자기 죽어버렸음</li>\n<li>KT 로드밸런서가 2번 서버로 계속 요청을 보냄</li>\n<li>사용자의 요청이 1번 서버로만 간 경우 정상적으로 서비스를 이용</li>\n<li>사용자의 요청이 2번으로 하나라도 가면 API의 응답을 받지 못함</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\">2017-08-04 19:40:51 [gajago-front] [redisMessageListenerContainer-1] ERROR org.springframework.data.redis.listener.RedisMessageListenerContainer:handleSubscriptionException:648 - SubscriptionTask aborted with exception:</div><div class=\"line\">java.lang.OutOfMemoryError: unable to create new native thread</div><div class=\"line\">        at java.lang.Thread.start0(Native Method)</div><div class=\"line\">        at java.lang.Thread.start(Thread.java:714)</div><div class=\"line\">        at org.springframework.core.task.SimpleAsyncTaskExecutor.doExecute(SimpleAsyncTaskExecutor.java:213)</div><div class=\"line\">        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:171)</div><div class=\"line\">        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:151)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer.dispatchMessage(RedisMessageListenerContainer.java:958)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer.access$1400(RedisMessageListenerContainer.java:71)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer$DispatchMessageListener.onMessage(RedisMessageListenerContainer.java:949)</div><div class=\"line\">        at org.springframework.data.redis.connection.jedis.JedisMessageListener.onPMessage(JedisMessageListener.java:43)</div><div class=\"line\">        at redis.clients.jedis.BinaryJedisPubSub.process(BinaryJedisPubSub.java:109)</div><div class=\"line\">        at redis.clients.jedis.BinaryJedisPubSub.proceedWithPatterns(BinaryJedisPubSub.java:75)</div><div class=\"line\">        at redis.clients.jedis.BinaryJedis.psubscribe(BinaryJedis.java:2953)</div><div class=\"line\">        at org.springframework.data.redis.connection.jedis.JedisConnection.pSubscribe(JedisConnection.java:2959)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.eventuallyPerformSubscription(RedisMessageListenerContainer.java:773)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.run(RedisMessageListenerContainer.java:740)</div><div class=\"line\">        at java.lang.Thread.run(Thread.java:745)</div><div class=\"line\">Exception in thread &quot;http-apr-10090-Acceptor-0&quot; java.lang.OutOfMemoryError: unable to create new native thread</div><div class=\"line\">        at java.lang.Thread.start0(Native Method)</div><div class=\"line\">        at java.lang.Thread.start(Thread.java:714)</div><div class=\"line\">        at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950)</div><div class=\"line\">        at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368)</div><div class=\"line\">        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:161)</div><div class=\"line\">        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:141)</div><div class=\"line\">        at org.apache.catalina.core.StandardThreadExecutor.execute(StandardThreadExecutor.java:169)</div><div class=\"line\">        at org.apache.tomcat.util.net.AprEndpoint.processSocketWithOptions(AprEndpoint.java:909)</div><div class=\"line\">        at org.apache.tomcat.util.net.AprEndpoint$Acceptor.run(AprEndpoint.java:1086)</div><div class=\"line\">        at java.lang.Thread.run(Thread.java:745)</div></pre></td></tr></table></figure>\n<h2 id=\"원인\"><a href=\"#원인\" class=\"headerlink\" title=\"원인\"></a>원인</h2><ol>\n<li><a href=\"https://github.com/spring-projects/spring-session\" target=\"_blank\" rel=\"external\">spring-session</a>에서 [spring-data-redis]를 사용할 때 <a href=\"https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L97\" target=\"_blank\" rel=\"external\">RedisMessageListenerContainer의 taskExecutor</a>에 별도의 값을 설정하지 않아서 <a href=\"https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java\" target=\"_blank\" rel=\"external\">SimpleAsyncTaskExecutor</a>를 사용하고 있음</li>\n<li><a href=\"https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html\" target=\"_blank\" rel=\"external\">SimpleAsyncTaskExecutor 문서</a>에서 이 클래스는 쓰레드를 재사용하지 않으니 실행시간이 짧은 많은 수의 작업에는 사용하지 말라고 권장하고 있음<ul>\n<li><code>NOTE: This implementation does not reuse threads! Consider a thread-pooling TaskExecutor implementation instead, in particular for executing a large number of short-lived tasks.</code></li>\n</ul>\n</li>\n<li>spring-session에서 세션정보에 접근하기 위해서 redis를 사용할 때 마다 Thread가 매번 생성됨</li>\n<li>접속량이 많이지게 되면 <code>OutOfMemoryError</code> 발생</li>\n</ol>\n<h2 id=\"해결책\"><a href=\"#해결책\" class=\"headerlink\" title=\"해결책\"></a>해결책</h2><ol>\n<li>SimpleAsyncTaskExecutor 대신에 ThreadPool을 사용할 수 있도록 지정한다</li>\n<li>하지만 지금 사용중인 <code>spring-session-1.0.2.RELEASE</code> 버전에서는 taskExecutor를 별도로 지정할 수 있는 방법이 없음</li>\n<li>결국 <code>spring-session-1.3.1.RELEASE</code> 버전으로 업데이트</li>\n<li><a href=\"https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92\" target=\"_blank\" rel=\"external\">패치된 내용</a>을 바탕으로 <code>springSessionRedisTaskExecutor</code>를 지정</li>\n<li><code>springSessionRedisTaskExecutor</code>를 지정하면 일어나는 일<ol>\n<li><code>springSessionRedisTaskExecutor</code>를 지정하면 <code>RedisHttpSessionConfiguration.redisTaskExecutor</code>에 지정한 <code>springSessionRedisTaskExecutor</code>가 할당 됨 <a href=\"https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L203\" target=\"_blank\" rel=\"external\">소스코드</a></li>\n<li><code>RedisMessageListenerContainer.taskExecutor</code>에 <code>RedisHttpSessionConfiguration.redisTaskExecutor</code>가 할당 됨 <a href=\"https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L93\" target=\"_blank\" rel=\"external\">소스코드</a></li>\n<li>spring-session에서 redis를 사용할 때 <code>springSessionRedisTaskExecutor</code>를 사용하게 됨 <a href=\"https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L961\" target=\"_blank\" rel=\"external\">소스코드</a></li>\n</ol>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Configuration</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FrontSessionConfig</span> </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Bean</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Executor <span class=\"title\">springSessionRedisTaskExecutor</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</div><div class=\"line\">            <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> threadCount = <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\">            <span class=\"meta\">@Override</span></div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable runnable)</span> </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(runnable, String.format(<span class=\"string\">\"gajago-session-redis-%d\"</span>, ++threadCount));</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> Executors.newCachedThreadPool(threadFactory);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"남아있는-과제\"><a href=\"#남아있는-과제\" class=\"headerlink\" title=\"남아있는 과제\"></a>남아있는 과제</h2><ol>\n<li>왜 1번 서버는 안 죽고 2번 서버만 죽었을까?</li>\n<li>KT 로드밸런서가 왜 2번 서버로 계속 요청을 보냈을까?</li>\n<li>캐시로 사용하고 있는 redis의 taskExecutor는?</li>\n</ol>\n<h2 id=\"관련자료\"><a href=\"#관련자료\" class=\"headerlink\" title=\"관련자료\"></a>관련자료</h2><ul>\n<li><a href=\"https://github.com/spring-projects/spring-session\" target=\"_blank\" rel=\"external\">https://github.com/spring-projects/spring-session</a></li>\n<li><a href=\"https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92\" target=\"_blank\" rel=\"external\">https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92</a></li>\n<li><a href=\"https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java\" target=\"_blank\" rel=\"external\">https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java</a></li>\n<li><a href=\"https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html\" target=\"_blank\" rel=\"external\">https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Trouble-Shooting-spring-session-OOME\"><a href=\"#Trouble-Shooting-spring-session-OOME\" class=\"headerlink\" title=\"[Trouble Shooting] spring-session OOME\"></a>[Trouble Shooting] spring-session OOME</h1><h2 id=\"증상\"><a href=\"#증상\" class=\"headerlink\" title=\"증상\"></a>증상</h2><ol>\n<li>2번 서버가 OutOfMemoryError로 갑자기 죽어버렸음</li>\n<li>KT 로드밸런서가 2번 서버로 계속 요청을 보냄</li>\n<li>사용자의 요청이 1번 서버로만 간 경우 정상적으로 서비스를 이용</li>\n<li>사용자의 요청이 2번으로 하나라도 가면 API의 응답을 받지 못함</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div></pre></td><td class=\"code\"><pre><div class=\"line\">2017-08-04 19:40:51 [gajago-front] [redisMessageListenerContainer-1] ERROR org.springframework.data.redis.listener.RedisMessageListenerContainer:handleSubscriptionException:648 - SubscriptionTask aborted with exception:</div><div class=\"line\">java.lang.OutOfMemoryError: unable to create new native thread</div><div class=\"line\">        at java.lang.Thread.start0(Native Method)</div><div class=\"line\">        at java.lang.Thread.start(Thread.java:714)</div><div class=\"line\">        at org.springframework.core.task.SimpleAsyncTaskExecutor.doExecute(SimpleAsyncTaskExecutor.java:213)</div><div class=\"line\">        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:171)</div><div class=\"line\">        at org.springframework.core.task.SimpleAsyncTaskExecutor.execute(SimpleAsyncTaskExecutor.java:151)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer.dispatchMessage(RedisMessageListenerContainer.java:958)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer.access$1400(RedisMessageListenerContainer.java:71)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer$DispatchMessageListener.onMessage(RedisMessageListenerContainer.java:949)</div><div class=\"line\">        at org.springframework.data.redis.connection.jedis.JedisMessageListener.onPMessage(JedisMessageListener.java:43)</div><div class=\"line\">        at redis.clients.jedis.BinaryJedisPubSub.process(BinaryJedisPubSub.java:109)</div><div class=\"line\">        at redis.clients.jedis.BinaryJedisPubSub.proceedWithPatterns(BinaryJedisPubSub.java:75)</div><div class=\"line\">        at redis.clients.jedis.BinaryJedis.psubscribe(BinaryJedis.java:2953)</div><div class=\"line\">        at org.springframework.data.redis.connection.jedis.JedisConnection.pSubscribe(JedisConnection.java:2959)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.eventuallyPerformSubscription(RedisMessageListenerContainer.java:773)</div><div class=\"line\">        at org.springframework.data.redis.listener.RedisMessageListenerContainer$SubscriptionTask.run(RedisMessageListenerContainer.java:740)</div><div class=\"line\">        at java.lang.Thread.run(Thread.java:745)</div><div class=\"line\">Exception in thread &quot;http-apr-10090-Acceptor-0&quot; java.lang.OutOfMemoryError: unable to create new native thread</div><div class=\"line\">        at java.lang.Thread.start0(Native Method)</div><div class=\"line\">        at java.lang.Thread.start(Thread.java:714)</div><div class=\"line\">        at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:950)</div><div class=\"line\">        at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1368)</div><div class=\"line\">        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:161)</div><div class=\"line\">        at org.apache.tomcat.util.threads.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:141)</div><div class=\"line\">        at org.apache.catalina.core.StandardThreadExecutor.execute(StandardThreadExecutor.java:169)</div><div class=\"line\">        at org.apache.tomcat.util.net.AprEndpoint.processSocketWithOptions(AprEndpoint.java:909)</div><div class=\"line\">        at org.apache.tomcat.util.net.AprEndpoint$Acceptor.run(AprEndpoint.java:1086)</div><div class=\"line\">        at java.lang.Thread.run(Thread.java:745)</div></pre></td></tr></table></figure>\n<h2 id=\"원인\"><a href=\"#원인\" class=\"headerlink\" title=\"원인\"></a>원인</h2><ol>\n<li><a href=\"https://github.com/spring-projects/spring-session\" target=\"_blank\" rel=\"external\">spring-session</a>에서 [spring-data-redis]를 사용할 때 <a href=\"https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L97\" target=\"_blank\" rel=\"external\">RedisMessageListenerContainer의 taskExecutor</a>에 별도의 값을 설정하지 않아서 <a href=\"https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java\" target=\"_blank\" rel=\"external\">SimpleAsyncTaskExecutor</a>를 사용하고 있음</li>\n<li><a href=\"https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html\" target=\"_blank\" rel=\"external\">SimpleAsyncTaskExecutor 문서</a>에서 이 클래스는 쓰레드를 재사용하지 않으니 실행시간이 짧은 많은 수의 작업에는 사용하지 말라고 권장하고 있음<ul>\n<li><code>NOTE: This implementation does not reuse threads! Consider a thread-pooling TaskExecutor implementation instead, in particular for executing a large number of short-lived tasks.</code></li>\n</ul>\n</li>\n<li>spring-session에서 세션정보에 접근하기 위해서 redis를 사용할 때 마다 Thread가 매번 생성됨</li>\n<li>접속량이 많이지게 되면 <code>OutOfMemoryError</code> 발생</li>\n</ol>\n<h2 id=\"해결책\"><a href=\"#해결책\" class=\"headerlink\" title=\"해결책\"></a>해결책</h2><ol>\n<li>SimpleAsyncTaskExecutor 대신에 ThreadPool을 사용할 수 있도록 지정한다</li>\n<li>하지만 지금 사용중인 <code>spring-session-1.0.2.RELEASE</code> 버전에서는 taskExecutor를 별도로 지정할 수 있는 방법이 없음</li>\n<li>결국 <code>spring-session-1.3.1.RELEASE</code> 버전으로 업데이트</li>\n<li><a href=\"https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92\" target=\"_blank\" rel=\"external\">패치된 내용</a>을 바탕으로 <code>springSessionRedisTaskExecutor</code>를 지정</li>\n<li><code>springSessionRedisTaskExecutor</code>를 지정하면 일어나는 일<ol>\n<li><code>springSessionRedisTaskExecutor</code>를 지정하면 <code>RedisHttpSessionConfiguration.redisTaskExecutor</code>에 지정한 <code>springSessionRedisTaskExecutor</code>가 할당 됨 <a href=\"https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L203\" target=\"_blank\" rel=\"external\">소스코드</a></li>\n<li><code>RedisMessageListenerContainer.taskExecutor</code>에 <code>RedisHttpSessionConfiguration.redisTaskExecutor</code>가 할당 됨 <a href=\"https://github.com/spring-projects/spring-session/blob/master/spring-session-data-redis/src/main/java/org/springframework/session/data/redis/config/annotation/web/http/RedisHttpSessionConfiguration.java#L93\" target=\"_blank\" rel=\"external\">소스코드</a></li>\n<li>spring-session에서 redis를 사용할 때 <code>springSessionRedisTaskExecutor</code>를 사용하게 됨 <a href=\"https://github.com/spring-projects/spring-data-redis/blob/master/src/main/java/org/springframework/data/redis/listener/RedisMessageListenerContainer.java#L961\" target=\"_blank\" rel=\"external\">소스코드</a></li>\n</ol>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"meta\">@Configuration</span></div><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FrontSessionConfig</span> </span>&#123;</div><div class=\"line\">    <span class=\"meta\">@Bean</span></div><div class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Executor <span class=\"title\">springSessionRedisTaskExecutor</span><span class=\"params\">()</span> </span>&#123;</div><div class=\"line\">        ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</div><div class=\"line\">            <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> threadCount = <span class=\"number\">0</span>;</div><div class=\"line\"></div><div class=\"line\">            <span class=\"meta\">@Override</span></div><div class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable runnable)</span> </span>&#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(runnable, String.format(<span class=\"string\">\"gajago-session-redis-%d\"</span>, ++threadCount));</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;;</div><div class=\"line\"></div><div class=\"line\">        <span class=\"keyword\">return</span> Executors.newCachedThreadPool(threadFactory);</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure>\n<h2 id=\"남아있는-과제\"><a href=\"#남아있는-과제\" class=\"headerlink\" title=\"남아있는 과제\"></a>남아있는 과제</h2><ol>\n<li>왜 1번 서버는 안 죽고 2번 서버만 죽었을까?</li>\n<li>KT 로드밸런서가 왜 2번 서버로 계속 요청을 보냈을까?</li>\n<li>캐시로 사용하고 있는 redis의 taskExecutor는?</li>\n</ol>\n<h2 id=\"관련자료\"><a href=\"#관련자료\" class=\"headerlink\" title=\"관련자료\"></a>관련자료</h2><ul>\n<li><a href=\"https://github.com/spring-projects/spring-session\" target=\"_blank\" rel=\"external\">https://github.com/spring-projects/spring-session</a></li>\n<li><a href=\"https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92\" target=\"_blank\" rel=\"external\">https://github.com/tsachev/spring-session/commit/6604bf180221028aff47f999418c0d48db72fb92</a></li>\n<li><a href=\"https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java\" target=\"_blank\" rel=\"external\">https://github.com/spring-projects/spring-framework/blob/master/spring-core/src/main/java/org/springframework/core/task/SimpleAsyncTaskExecutor.java</a></li>\n<li><a href=\"https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html\" target=\"_blank\" rel=\"external\">https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/core/task/SimpleAsyncTaskExecutor.html</a></li>\n</ul>\n"},{"title":"ts-ios-wifi-webkit-error","date":"2017-08-24T10:17:22.000Z","_content":"\n# [Trouble Shooting] iOS WiFi parse error\n\n## 증상\n1. iOS 사파리에서 [가자고](https://www.thegajago.com) 사이트를 열면 ``오류: WebKit에 내부 오류 발생``이라고 보여진다.\n  - <img src=\"/2017/08/24/ts-ios-wifi-webkit-error/webkit-error.png\" style=\"height:200px;\" />\n2. 사이트의 반응이 매우 느리며 불특정 페이지에서 발생한다.\n3. WiFi 연결일때만 발생하며 LTE 연결인 경우 오류가 발생하지 않는다.\n4. iOS 10.2 버전 업데이트 이후부터 발생된다.\n\n\n## 원인\n1. iOS WiFi 연결상태에서 gzip decoding에 뭔가 문제가 있는것 같다.\n  - 사실 정확한 원인 및 문서를 찾지 못했다.\n\n\n## 해결책\n1. gzip 옵션을 off 한다.\n```conf\n...\n    gzip on; // -> off\n    gzip_types text/plain application/xml text/css text/js text/xml application/x-javascript text/javascript application/json appplication/xml+rss;\n    gzip_http_version 1.1;\n    gzip_disable \"MSIE [1-6] \\.\";\n    gzip_vary on;\n...\n```\n\n\n## 남아있는 과제\n1. nginx gzip 모듈 버전을 업데이트하면 괜찮지 않을까?\n2. gzip을 iOS에서만 off 하도록 gzip_disable 값을 셋팅하자.\n\n## 관련자료\n- 없음","source":"_posts/ts-ios-wifi-webkit-error.md","raw":"---\ntitle: ts-ios-wifi-webkit-error\ndate: 2017-08-24 19:17:22\ntags:\n---\n\n# [Trouble Shooting] iOS WiFi parse error\n\n## 증상\n1. iOS 사파리에서 [가자고](https://www.thegajago.com) 사이트를 열면 ``오류: WebKit에 내부 오류 발생``이라고 보여진다.\n  - <img src=\"/2017/08/24/ts-ios-wifi-webkit-error/webkit-error.png\" style=\"height:200px;\" />\n2. 사이트의 반응이 매우 느리며 불특정 페이지에서 발생한다.\n3. WiFi 연결일때만 발생하며 LTE 연결인 경우 오류가 발생하지 않는다.\n4. iOS 10.2 버전 업데이트 이후부터 발생된다.\n\n\n## 원인\n1. iOS WiFi 연결상태에서 gzip decoding에 뭔가 문제가 있는것 같다.\n  - 사실 정확한 원인 및 문서를 찾지 못했다.\n\n\n## 해결책\n1. gzip 옵션을 off 한다.\n```conf\n...\n    gzip on; // -> off\n    gzip_types text/plain application/xml text/css text/js text/xml application/x-javascript text/javascript application/json appplication/xml+rss;\n    gzip_http_version 1.1;\n    gzip_disable \"MSIE [1-6] \\.\";\n    gzip_vary on;\n...\n```\n\n\n## 남아있는 과제\n1. nginx gzip 모듈 버전을 업데이트하면 괜찮지 않을까?\n2. gzip을 iOS에서만 off 하도록 gzip_disable 값을 셋팅하자.\n\n## 관련자료\n- 없음","slug":"ts-ios-wifi-webkit-error","published":1,"updated":"2017-08-24T12:02:01.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6rdbook0001xpwcm2mf1jht","content":"<h1 id=\"Trouble-Shooting-iOS-WiFi-parse-error\"><a href=\"#Trouble-Shooting-iOS-WiFi-parse-error\" class=\"headerlink\" title=\"[Trouble Shooting] iOS WiFi parse error\"></a>[Trouble Shooting] iOS WiFi parse error</h1><h2 id=\"증상\"><a href=\"#증상\" class=\"headerlink\" title=\"증상\"></a>증상</h2><ol>\n<li>iOS 사파리에서 <a href=\"https://www.thegajago.com\" target=\"_blank\" rel=\"external\">가자고</a> 사이트를 열면 <code>오류: WebKit에 내부 오류 발생</code>이라고 보여진다.<ul>\n<li><img src=\"/2017/08/24/ts-ios-wifi-webkit-error/webkit-error.png\" style=\"height:200px;\"></li>\n</ul>\n</li>\n<li>사이트의 반응이 매우 느리며 불특정 페이지에서 발생한다.</li>\n<li>WiFi 연결일때만 발생하며 LTE 연결인 경우 오류가 발생하지 않는다.</li>\n<li>iOS 10.2 버전 업데이트 이후부터 발생된다.</li>\n</ol>\n<h2 id=\"원인\"><a href=\"#원인\" class=\"headerlink\" title=\"원인\"></a>원인</h2><ol>\n<li>iOS WiFi 연결상태에서 gzip decoding에 뭔가 문제가 있는것 같다.<ul>\n<li>사실 정확한 원인 및 문서를 찾지 못했다.</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"해결책\"><a href=\"#해결책\" class=\"headerlink\" title=\"해결책\"></a>해결책</h2><ol>\n<li>gzip 옵션을 off 한다.<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">...</div><div class=\"line\">    gzip on; // -&gt; off</div><div class=\"line\">    gzip_types text/plain application/xml text/css text/js text/xml application/x-javascript text/javascript application/json appplication/xml+rss;</div><div class=\"line\">    gzip_http_version 1.1;</div><div class=\"line\">    gzip_disable &quot;MSIE [1-6] \\.&quot;;</div><div class=\"line\">    gzip_vary on;</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"남아있는-과제\"><a href=\"#남아있는-과제\" class=\"headerlink\" title=\"남아있는 과제\"></a>남아있는 과제</h2><ol>\n<li>nginx gzip 모듈 버전을 업데이트하면 괜찮지 않을까?</li>\n<li>gzip을 iOS에서만 off 하도록 gzip_disable 값을 셋팅하자.</li>\n</ol>\n<h2 id=\"관련자료\"><a href=\"#관련자료\" class=\"headerlink\" title=\"관련자료\"></a>관련자료</h2><ul>\n<li>없음</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"Trouble-Shooting-iOS-WiFi-parse-error\"><a href=\"#Trouble-Shooting-iOS-WiFi-parse-error\" class=\"headerlink\" title=\"[Trouble Shooting] iOS WiFi parse error\"></a>[Trouble Shooting] iOS WiFi parse error</h1><h2 id=\"증상\"><a href=\"#증상\" class=\"headerlink\" title=\"증상\"></a>증상</h2><ol>\n<li>iOS 사파리에서 <a href=\"https://www.thegajago.com\" target=\"_blank\" rel=\"external\">가자고</a> 사이트를 열면 <code>오류: WebKit에 내부 오류 발생</code>이라고 보여진다.<ul>\n<li><img src=\"/2017/08/24/ts-ios-wifi-webkit-error/webkit-error.png\" style=\"height:200px;\"></li>\n</ul>\n</li>\n<li>사이트의 반응이 매우 느리며 불특정 페이지에서 발생한다.</li>\n<li>WiFi 연결일때만 발생하며 LTE 연결인 경우 오류가 발생하지 않는다.</li>\n<li>iOS 10.2 버전 업데이트 이후부터 발생된다.</li>\n</ol>\n<h2 id=\"원인\"><a href=\"#원인\" class=\"headerlink\" title=\"원인\"></a>원인</h2><ol>\n<li>iOS WiFi 연결상태에서 gzip decoding에 뭔가 문제가 있는것 같다.<ul>\n<li>사실 정확한 원인 및 문서를 찾지 못했다.</li>\n</ul>\n</li>\n</ol>\n<h2 id=\"해결책\"><a href=\"#해결책\" class=\"headerlink\" title=\"해결책\"></a>해결책</h2><ol>\n<li>gzip 옵션을 off 한다.<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">...</div><div class=\"line\">    gzip on; // -&gt; off</div><div class=\"line\">    gzip_types text/plain application/xml text/css text/js text/xml application/x-javascript text/javascript application/json appplication/xml+rss;</div><div class=\"line\">    gzip_http_version 1.1;</div><div class=\"line\">    gzip_disable &quot;MSIE [1-6] \\.&quot;;</div><div class=\"line\">    gzip_vary on;</div><div class=\"line\">...</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"남아있는-과제\"><a href=\"#남아있는-과제\" class=\"headerlink\" title=\"남아있는 과제\"></a>남아있는 과제</h2><ol>\n<li>nginx gzip 모듈 버전을 업데이트하면 괜찮지 않을까?</li>\n<li>gzip을 iOS에서만 off 하도록 gzip_disable 값을 셋팅하자.</li>\n</ol>\n<h2 id=\"관련자료\"><a href=\"#관련자료\" class=\"headerlink\" title=\"관련자료\"></a>관련자료</h2><ul>\n<li>없음</li>\n</ul>\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}